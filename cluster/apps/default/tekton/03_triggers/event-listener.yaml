---
apiVersion: triggers.tekton.dev/v1alpha1
kind: EventListener
metadata:
  name: shared-listener
  namespace: default
spec:
  serviceAccountName: tekton-triggers-admin
  triggers:
    - name: shared-pipeline-trigger
      interceptors:
        - cel:
            overlays:
            - key: intercepted.commit_id_short
              expression: "body.head_commit.id.truncate(7)"
            - key: intercepted.multi_arch
              expression: "body.repository.name == 'garage-opener' ? 'linux/arm/v7' : 'linux/arm/v7,linux/amd64,linux/arm/v6,linux/arm64'"
      bindings:
        - ref: pipeline-binding
      template:
        ref: pipeline-template
