common:
  nameOverride: "room-assistant"
  fullnameOverride: "room-assistant"
  replicas: 1
  image:
    repository: mkerix/room-assistant
    pullPolicy: IfNotPresent
    tag: "2.19.1"

  strategy:
    type: Recreate

  securityContext:
    privileged: true
    capabilities:
      add:
        - NET_ADMIN

  probes:
    liveness:
      enabled: false
    readiness:
      enabled: false
    startup:
      enabled: false

  ingress:
    enabled: false

  hostNetwork: true

  envValueFrom:
    NODE_NAME:
      fieldRef:
        fieldPath: spec.nodeName
  env:
    NODE_CONFIG: >
      {
        "global": {
          "instanceName": "$(NODE_NAME)",
          "integrations": [
            "homeAssistant",
            "bluetoothClassic"
          ]
        },
        "homeAssistant": {
          "mqttUrl": "mqtt://192.168.20.109:1883",
          "qos": "1",
          "retain": "true"
        },
        "bluetoothClassic": {
          "addresses": [
            "0c:c4:13:1b:66:0e"
          ]
        }
      }
    TZ: "America/Chicago"

  resources:
    limits:
      cpu: 520m
      memory: 520Mi
    requests:
      cpu: 250m
      memory: 250Mi

  tolerations:
    - key: "k3s-arm"
      operator: "Exists"

  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - {
                  key: "feature.node.kubernetes.io/custom-room-assistant",
                  operator: In,
                  values: ["true"],
                }
